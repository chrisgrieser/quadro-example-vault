/* THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
If you want to view the source, please visit the GitHub repository of this plugin. */

"use strict";var Ae=Object.defineProperty;var $t=Object.getOwnPropertyDescriptor;var Lt=Object.getOwnPropertyNames;var Mt=Object.prototype.hasOwnProperty;var Nt=(o,e)=>{for(var t in e)Ae(o,t,{get:e[t],enumerable:!0})},Qt=(o,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Lt(e))!Mt.call(o,i)&&i!==t&&Ae(o,i,{get:()=>e[i],enumerable:!(n=$t(e,i))||n.enumerable});return o};var Rt=o=>Qt(Ae({},"__esModule",{value:!0}),o);var Yt={};Nt(Yt,{default:()=>Oe});module.exports=Rt(Yt);var Ot=require("obsidian");var ze=require("obsidian");var Q={extractionOverview:"quadro-extractiontype-overview",codeOverview:"quadro-code-overview"},j="pre-merge-backups",oe="read";async function Ue(o){let e=o.app,t=o.app.workspace.getActiveFile()?.path||"",n=e.vault.getMarkdownFiles().filter(s=>{let a=s.path!==t,c=e.metadataCache.getFileCache(s)?.frontmatter?.[oe]===!1;return a&&c});if(n.length===0){new ze.Notice(`No notes in with "${oe}: false" found.`);return}let i=Math.floor(Math.random()*n.length),r=n[i];await e.workspace.getLeaf().openFile(r)}var M=require("obsidian");var K=require("obsidian");function g(o,e){let{app:t,settings:n}=o;return e||(e=t.workspace.getActiveFile()),typeof e=="string"&&(e=t.vault.getFileByPath(e)),e?!(e instanceof K.TFile)||e.extension!=="md"?"Not Markdown":e.name==="Template.md"?"Template":e.path.includes(j)?"Backup":e.path.startsWith(n.coding.folder+"/")?"Code File":e.path.startsWith(n.extraction.folder+"/")?"Extraction File":"Data File":"No File"}function q(o){if(o.getLine(o.getCursor().line).trim()==="")return new K.Notice(`Current line is empty.

Move cursor to a paragraph and try again.`,5e3),!0;let t="";return o.listSelections().length>1&&(t="Multiple selections are not supported."),o.getSelection().includes(`

`)&&(t="Multiple paragraphs are selected."),o.getSelection().match(/^\n|\n$/)&&(t="Selection starts or ends with a line break."),t?(t+=`

Change your selection and try again.`,new K.Notice(t,5e3),!0):!1}function z(o){let e=o.getSelection().includes("==");return e&&new K.Notice(`Selection contains highlights.
Overlapping highlights are not supported.`,4e3),e}function pe(o){let e=o.workspace.getActiveFile();if(!e)return!1;let t=e.basename.match(/[|^#]/)?.[0];if(!t)return!1;let n=`The current file contains an invalid character: ${t}

Rename the file and try again.`;return new K.Notice(n,0),!0}function Ge(o){let e=o.settings.analysis.folder;return(0,M.normalizePath)(e+"/"+"progress.json")}function Xe(o){o.app.showInFolder(Ge(o))}function Je(o){let e=o.app,t=e.workspace.getActiveFile();if(!(g(o,t)==="Data File"&&t instanceof M.TFile)){new M.Notice("Current file is not a Data File.",4e3);return}if(e.metadataCache.getFileCache(t)?.frontmatter?.[oe]){new M.Notice("Data File already marked as read.",4e3);return}e.fileManager.processFrontMatter(t,r=>{r.read=!0}),E(o,"Data File","read"),new M.Notice("Marked current Data File as read.")}async function E(o,e,t){let{app:n}=o,i=(0,M.moment)().format("YYYY-MM-DD"),r=Ge(o),a=await n.vault.adapter.exists(r)?JSON.parse(await n.vault.adapter.read(r)):{};a[i]||(a[i]={}),a[i][e]||(a[i][e]={}),a[i][e][t]||(a[i][e][t]=0),a[i][e][t]++,n.vault.adapter.write(r,JSON.stringify(a,null,2))}var Ze=[{id:"open-random-unread-datafile",name:"Open random unread Data File",func:Ue,hotkeyLetter:"n",icon:"shuffle"},{id:"show-progress",name:"Show data analysis progress file",func:Xe,icon:"flag-triangle-right"},{id:"mark-datafile-as-read",name:"Mark current Data File as read",func:Je,hotkeyLetter:"r",icon:"file-check"}];var ne={"last used first":(o,e)=>e.stat.mtime-o.stat.mtime,"oldest used first":(o,e)=>o.stat.mtime-e.stat.mtime,"frequently used first":(o,e)=>e.stat.size-o.stat.size,"rarely used first":(o,e)=>o.stat.size-e.stat.size,random:()=>Math.random()-.5,alphabetical:(o,e)=>o.basename.localeCompare(e.basename)},et={",":"Comma (,)",";":"Semicolon (;)","	":"Tab"},tt={"right-split":"to the right","down-split":"to the bottom",tab:"in new tab"},N={coding:{folder:"Codes",displayCount:!0,sortFunc:"last used first"},extraction:{folder:"Extractions",displayCount:!0,openingMode:"tab",csvSeparator:",",ignorePropertyOnMerge:[],displayProperty:[]},analysis:{folder:"Analysis"},suppressSuggestionInFields:[],propertiesKeysWidthPercent:35,statusbar:{shortened:!1}};var me=require("obsidian"),ue={state:{source:!1,mode:"source"}},U=/\[\[(.+?)([|#].*?)?\]\]/;async function fe(o,e,t){let{app:n,settings:i}=o,r=i.analysis.folder;n.vault.getFolderByPath(r)||n.vault.createFolder(r);let a=(0,me.normalizePath)(r+`/${e}.md`),l=n.vault.getFileByPath(a);l?await n.vault.modify(l,t.join(`
`)):l=await n.vault.create(a,t.join(`
`)),await n.workspace.getLeaf().openFile(l,ue),P(n)?.setCursor({line:0,ch:0}),n.commands.executeCommandById("file-explorer:reveal-active-file")}function P(o){let e=o.workspace.activeEditor?.editor;return e||new me.Notice("No active editor."),e}function he(o){let e=o.getCursor().line;for(;;){let t=o.getLine(e+1).trim()==="",n=o.getLine(e).match(/^\s*([-*+]|[0-9]+\.)\s/);if(t||n)break;e++,o.setCursor({line:e,ch:0})}return e}function ge(o){o.metadataTypeManager.setType("extraction-date","datetime"),o.metadataTypeManager.setType("merge-date","datetime"),o.metadataTypeManager.setType("extraction-source","multitext"),o.metadataTypeManager.setType("code description","text")}function ie(o,e){return e.path.slice(o.settings.coding.folder.length+1,-3)}function re(o,e){let t=o.app.metadataCache.resolvedLinks[e.path]||{},n=0;for(let[i,r]of Object.entries(t))g(o,i)==="Data File"&&(n+=r);return n}function ye(o,e,t){let n=o.app;return(t.match(new RegExp(U,"g"))||[]).reduce((s,a)=>{let[l,c]=a.match(U)||[];if(!c)return s;let p=n.metadataCache.getFirstLinkpathDest(c,e.path);return p&&g(o,p)==="Code File"&&s.push({tFile:p,wikilink:a}),s},[])}function Fe(o){let e=o.app.vault.getMarkdownFiles().filter(n=>g(o,n)==="Code File"),t=ne[o.settings.coding.sortFunc];return e.sort(t),e}function G(o,e){let t=ie(o,e);if(!o.settings.coding.displayCount)return t;let i=re(o,e);return`${t} (${i}x)`}var R=require("obsidian");var Ce=require("obsidian"),O=class extends Ce.FuzzySuggestModal{hotkeyInstructions=[{command:"\u2191 \u2193",purpose:"Navigate"},{command:"\u21B9 ",purpose:"Down"},{command:"shift \u21B9 ",purpose:"Up"},{command:"\u23CE",purpose:"Select"},{command:"esc",purpose:"Dismiss"}];plugin;settings;constructor(e){super(e.app),this.plugin=e,this.settings=e.settings,this.modalEl.addClass(e.cssclass),this.setInstructions(this.hotkeyInstructions),this.scope.register([],"Tab",()=>{document.dispatchEvent(new KeyboardEvent("keydown",{key:"ArrowDown"}))}),this.scope.register(["Shift"],"Tab",()=>{document.dispatchEvent(new KeyboardEvent("keydown",{key:"ArrowUp"}))})}},Y=class extends Ce.Modal{plugin;confirmationButton;constructor(e){super(e.app),this.plugin=e,this.modalEl.addClass(e.cssclass)}onClose(){this.contentEl.empty()}};async function se(o,e){let{app:t,settings:n}=o,i=n.extraction.openingMode,r=t.workspace.getLeaf();if(i==="tab"){let s=r.parent;await t.workspace.createLeafInParent(s,s.children.length).openFile(e,ue)}else{let s=i==="right-split"?"right":"bottom",a=i==="right-split"?"vertical":"horizontal",l=t.workspace.getAdjacentLeafInDirection(r,s)||t.workspace.createLeafBySplit(r,a,!1);await l.openFile(e,ue),l.parent.setDimension(2)}}function we(o,e){o.vault.setConfig("propertiesInDocument","visible"),setTimeout(()=>{let t=o.workspace.getActiveViewOfType(R.MarkdownView)?.metadataEditor.rendered[0];if(!t)return;t[e==="key"?"focusKey":"focusValue"]()},350)}var X=class extends O{extractionTypes;callback;constructor(e,t){super(e),this.extractionTypes=ae(e),this.callback=t,this.setPlaceholder("Select extraction type")}getItems(){return this.extractionTypes.sort((e,t)=>{let n=$(this.plugin,e).length;return $(this.plugin,t).length-n})}getItemText(e){if(!this.plugin.settings.extraction.displayCount)return e.name;let n=$(this.plugin,e).length;return`${e.name} (${n}x)`}onChooseItem(e){this.callback(e)}};function xe(o,e){let{app:t,settings:n}=o,i=t.metadataCache.getFileCache(e)?.frontmatter,r=n.extraction.displayProperty;if(!i||r.length===0)return e.basename;let s=i?.["extraction-source"]?.length||0,a=s>1?`${s}x`:"",l=r.find(d=>{let f=i[d];return Array.isArray(f)?f.length>0:f||f===0});if(!l)return e.basename;let c=i[l];Array.isArray(c)&&(c=c.join(", "));let p=c?`${l}: ${c}`:"";return[e.basename,a,p].filter(Boolean).join("  \u2B29  ")}function ve(o,e){let t=o.vault.getFileByPath(`${e.path}/Template.md`);if(!t){new R.Notice(`ERROR: Could not find "Template.md" for Extraction Type "${e.name}".`,0);return}let n=o.metadataCache.getFileCache(t)?.frontmatter;if(!n){new R.Notice(`ERROR: Properties of "Template.md" for Extraction Type "${e.name}" are invalid.`,0);return}return n}function ae(o){let{app:e,settings:t}=o,n=e.vault.getFolderByPath(t.extraction.folder);if(!n){new R.Notice("Error: could not find Extraction Folder.",0);return}let i=n.children.filter(r=>r instanceof R.TFolder&&r.children.find(s=>s.name==="Template.md"));if(i.length===0){let r=["ERROR: Could not find any valid Extraction Types.",'Check that the extraction folder has subfolders, and that the subfolder has a "Template.md" file.','You can also create a new extraction type with the command "Create new extraction type" or by pressing the button with the dashed box in the left sidebar.'].join(`

`);new R.Notice(r,0);return}return i}function $(o,e){return e.children.filter(n=>g(o,n)==="Extraction File")}function J(o){let{app:e,statusbar:t,settings:n}=o,i=n.statusbar.shortened,r=[],s=g(o),a=e.workspace.getActiveFile();if(!a||!["Data File","Code File","Extraction File"].includes(s)){t.setText(""),t.setCssProps({display:"none"});return}if(s==="Code File"){let d=re(o,a),f=i?`${d}C`:`Code ${d}x assigned`;r.push(f)}else if(s==="Extraction File"){let m=a.parent;if(m){let d=$(o,m).length,f=i?`${d}E`:`${d}x extracted`;r.push(f)}}else if(s==="Data File"){let m=e.metadataCache.resolvedLinks[a.path]||{},d=0,f=0;for(let[y,T]of Object.entries(m))y.startsWith(n.coding.folder+"/")&&(d+=T),y.startsWith(n.extraction.folder+"/")&&f++;d>0&&r.push(`${d}${i?"C":" Codes"}`),f>0&&r.push(`${f}${i?"E":" Extractions"}`)}let l=e.metadataCache.unresolvedLinks[a.path]||{},c=0;for(let[m,d]of Object.entries(l))c+=d;if(c>0&&r.push(`${c}${i?"?":"invalid links"}`),r.length===0){t.setText(""),t.setCssProps({display:"none"});return}let p=i?r.join(" "):r.map(m=>m.startsWith("1 ")?m.slice(0,-1):m).join(", ");t.setText(p),t.setCssProps({display:"block"})}var B=require("obsidian");async function ot(o){let e=["*This file updates automatically, any manual changes to it will be lost.*","","```"+Q.codeOverview,"```",""];await fe(o,"Code Overview",e)}function nt(o,e){let{app:t,settings:n}=o,i=[...e.children];i.sort((s,a)=>s instanceof B.TFolder&&a instanceof B.TFile?-1:s instanceof B.TFile&&a instanceof B.TFolder?1:s.name.localeCompare(a.name));let r="";for(let s of i)if(s instanceof B.TFolder){let a=s;if(!a.children.some(p=>p instanceof B.TFile&&p.extension==="md"))continue;let c=nt(o,a);r+=`<li>\u{1F4C1} ${a.name} ${c}</li>`}else if(s instanceof B.TFile){let a=s,l=a.path===n.coding.folder+"/Template.md",c=a.extension!=="md";if(l||c)continue;let p=t.metadataCache.getFileCache(a)?.frontmatter?.["code description"],m=p?": "+p:"",d=`<a href="${a.path}" class="internal-link">${a.basename}</a>`,f=re(o,a);r+=`<li>\u{1F4C4} ${d} (${f}x)${m}</li>`}return`<ul>${r}</ul>`}function it(o){let{app:e,settings:t}=o,n=e.vault.getFolderByPath(t.coding.folder);return n?nt(o,n):`\u26A0\uFE0F Code folder "${t.coding.folder}" not found.`}var Ne=require("obsidian");var I=require("obsidian");var Te=require("obsidian");var H=class extends Te.AbstractInputSuggest{textInputEl;plugin;foldersInVault;constructor(e,t){super(e.app,t),this.textInputEl=t,this.plugin=e,this.foldersInVault=e.app.vault.getAllLoadedFiles().filter(n=>n instanceof Te.TFolder)}getSuggestions(e){return this.foldersInVault.filter(t=>t.path.includes(e))}renderSuggestion(e,t){t.createEl("span",{text:e.path})}selectSuggestion(e){this.textInputEl.value=e.path,this.textInputEl.trigger("input"),this.close()}};function rt(o,e){return e.path.slice(o.settings.coding.folder.length+1)+"/"}var Ee=class extends H{getSuggestions(e){if(!e.includes("/"))return[];let t=this.plugin.settings;return this.foldersInVault.filter(i=>{let r=i.path.includes(e),s=i.path.startsWith(t.coding.folder+"/"),a=!i.path.includes(j);return r&&s&&a})}renderSuggestion(e,t){let n=rt(this.plugin,e);t.createEl("span",{text:n})}selectSuggestion(e){this.textInputEl.value=rt(this.plugin,e),this.textInputEl.trigger("input"),this.close()}};var $e=class extends Y{fullCode="";codeDesc="";onSubmit;constructor(e,t){super(e),this.onSubmit=t}onOpen(){let{contentEl:e}=this;e.addClass(this.plugin.cssclass);let t=i=>i!==""&&!i.startsWith("/")&&!i.endsWith("/"),n=()=>{this.close(),this.onSubmit(this.fullCode,this.codeDesc)};e.createEl("h4",{text:"New code creation"}),e.createEl("small",{text:'If there is a file "Template.md" at the root of the Codes Folder, the new Code File will be populated with its frontmatter.'}),e.createEl("br",{}),e.createEl("br",{}),new I.Setting(e).setName("Name of the code").setDesc('Use a slash ("/") in the name to create the Code File in a subfolder (group). Example: "groupname/codename".').addText(i=>{new Ee(this.plugin,i.inputEl),i.onChange(r=>{this.fullCode=r.trim(),this.confirmationButton?.setDisabled(!t(this.fullCode))}).inputEl.addClass("quadro-wide-input"),i.inputEl.addEventListener("keydown",r=>{r.key==="Enter"&&t(this.fullCode)&&(r.preventDefault(),n())})}),new I.Setting(e).setName("Code description").setDesc('Will be added as metadata with the key "code description".').addText(i=>{i.onChange(r=>{this.codeDesc=r.trim()}).inputEl.addClass("quadro-wide-input"),i.inputEl.addEventListener("keydown",r=>{r.key==="Enter"&&t(this.fullCode)&&(r.preventDefault(),n())})}),new I.Setting(e).addButton(i=>{this.confirmationButton=i.setButtonText("Create").setCta().setDisabled(!0).onClick(n)}).addButton(i=>i.setButtonText("Cancel").onClick(()=>this.close()))}},Le=class extends Y{input="";onSubmit;constructor(e,t){super(e),this.onSubmit=t}onOpen(){let{contentEl:e}=this;e.addClass(this.plugin.cssclass),e.createEl("h4",{text:"Bulk-create new codes"}),e.createEl("p",{text:"Every line will result in a new Code File."}),e.createEl("p",{text:'Use a slash ("/") in the name to create the Code File in a subfolder (group).'}),e.createEl("p",{text:'If there is a file "Template.md" at the root of the Codes Folder, the new Code Files will be populated with its frontmatter.'}),new I.Setting(e).addTextArea(t=>{t.onChange(n=>{this.input=n.trim(),this.confirmationButton?.setDisabled(this.input==="")}).inputEl.addClass("quadro-large-textarea")}).infoEl.remove(),new I.Setting(e).addButton(t=>{this.confirmationButton=t.setButtonText("Create").setCta().setDisabled(!0).onClick(()=>{this.close(),this.onSubmit(this.input)})}).addButton(t=>t.setButtonText("Cancel").onClick(()=>this.close()))}};async function st(o,e,t){let{app:n,settings:i}=o;e=e.replace(/\.md$/,"").replace(/[:#^?!"*<>|[\]\\]/g,"-").replace(/^\.|\/\./g,"").replace(/^\/+|\/+$/g,"");let r=(0,I.normalizePath)(`${i.coding.folder}/${e}.md`);if(n.vault.getFileByPath(r))return new I.Notice(`Code "${e}" already exists, Code File not created.`,0),!1;let a=e.split("/"),l=a.pop(),c=a.length>0?"/"+a.join("/"):"",p=i.coding.folder+c;n.vault.getFolderByPath(p)||await n.vault.createFolder(p);let d=`code description: "${t.replaceAll('"',"'")}"`,f=n.vault.getFileByPath(i.coding.folder+"/Template.md"),y=[];if(f){let w=/^code description: (.*)$/m,S=await n.vault.read(f),{exists:u,frontmatter:F}=(0,I.getFrontMatterInfo)(S);u&&(F=F.match(w)?F.replace(w,d):d+`
`+F,y.push(...F.trim().split(`
`)))}else y.push(d);let T=["---",...y,"---","",""],C=await n.vault.create(`${p}/${l}.md`,T.join(`
`));return C?(new I.Notice(`Created new code file: "${e}"`,3500),E(o,"Code File","new"),C):(new I.Notice("Failed to create new Code File.",0),!1)}function at(o,e){new $e(o,async(t,n)=>{let i=await st(o,t,n);i&&e(i)}).open()}function ct(o){new Le(o,async e=>{let t=0,n=[];for(let r of e.split(`
`))await st(o,r,"")?t++:n.push(r);let i=`${t} file(s) created`;n.length>0&&(i+=`
Could not create: `+n.join(", ")),new I.Notice(i,n.length>0?0:3e3)}).open()}var lt=require("obsidian");var Me=/\^[\w-]+$/;function Z(o){let e=o.getSelection();if(e){let a=e.replace(/^( ?)(.+?)( ?)$/g,"$1==$2==$3");o.replaceSelection(a)}let t=he(o),n=o.getLine(t),[i]=n.match(Me)||[],r=i||"^id-"+(0,lt.moment)().format("YYYY-MM-DD--HH-mm-ss"),s=i?n.slice(0,-i.length):n;return{blockId:r,lineWithoutId:s.trim()}}function ee(o,e,t,n,i){let r=o.editorComponent.view.file;if(!r)return;let s=o.editorComponent.app;s.vault.setConfig("useMarkdownLinks",!1);let a=s.fileManager.generateMarkdownLink(e,r.path,"",t),l=[n,a,i].join(" "),c=o.getCursor();o.setLine(c.line,l),o.setCursor(c)}var Qe=class extends O{editor;codesInPara;dataFile;constructor(e,t,n,i){super(e),this.editor=t,this.codesInPara=n,this.dataFile=i,this.setPlaceholder("Select code to assign"),this.setInstructions([...this.hotkeyInstructions,{command:"shift \u23CE",purpose:"Create new code"}]),this.scope.register(["Shift"],"Enter",r=>{r.isComposing||(r.preventDefault(),this.close(),this.onChooseItem("new-code-file"))})}getItems(){return[...Fe(this.plugin).filter(n=>!this.codesInPara.find(i=>i.path===n.path)),"new-code-file"]}getItemText(e){return e==="new-code-file"?"\u2B51 Create new code":G(this.plugin,e)}onChooseItem(e){e==="new-code-file"?at(this.plugin,t=>this.assignCode(t,this.dataFile)):this.assignCode(e,this.dataFile)}async assignCode(e,t){let n=this.editor,i=ie(this.plugin,e),{blockId:r,lineWithoutId:s}=Z(n);ee(n,e,i,s,r);let a=`![[${t.path.slice(0,-3)}#${r}]]
`;await this.app.vault.append(e,a),E(this.plugin,"Code File","assign")}};function dt(o){let{app:e}=o,t=P(e);if(!t||q(t)||z(t)||pe(e))return;if(g(o)!=="Data File"){new Ne.Notice("You must be in a Data File to assign a code.",4e3);return}let i=t.editorComponent.view.file;if(!i){new Ne.Notice("No file open.",4e3);return}let r=t.getLine(t.getCursor().line),s=ye(o,i,r).map(a=>a.tFile);new Qe(o,t,s,i).open()}var Re=require("obsidian");async function pt(o){let e=o.app,t=P(e);if(!t)return;if(g(o)!=="Code File"){new Re.Notice("Must be in a Code File to delete the code everywhere.",4e3);return}let n=t.editorComponent.view.file;if(!n){new Re.Notice("No file open.",4e3);return}await e.vault.trash(n,!0)}var ke=require("obsidian");var A=require("obsidian");function Bt(o){o.workspace.activeEditor?.editor?.editorComponent?.view?.currentMode?.cleanupLivePreview?.()}async function be(o,e,t,n,i){let{app:r,settings:s}=o;n=(0,A.normalizePath)(n+"/"+j),r.vault.getFolderByPath(n)||await r.vault.createFolder(n);let a=(0,A.moment)().format("YY-MM-DD_HH-mm-ss");await r.vault.copy(e,`${n}/${e.basename} ${a}.md`),await r.vault.copy(t,`${n}/${t.basename} ${a}.md`);let l=[...s.extraction.ignorePropertyOnMerge,"extraction-date","merge-date"],c=r.metadataCache.getFileCache(t)?.frontmatter||{},p={};await r.fileManager.processFrontMatter(e,u=>{for(let F in c){if(!Object.hasOwn(c,F))continue;let h=u[F],v=c[F],D=!h&&h!==0&&h!==!1,b=!v&&v!==0&&v!==!1;if(!(l.includes(F)||h===v||b)){if(D){u[F]=v;continue}if(Array.isArray(h)&&Array.isArray(v)){u[F]=[...new Set([...h,...v])];continue}u[F]=h,p[F]=v}}u["merge-date"]=(0,A.moment)().format("YYYY-MM-DDTHH:mm")});let m=await r.vault.cachedRead(t);await r.vault.process(e,u=>{let F=u.slice((0,A.getFrontMatterInfo)(u).contentStart),h=m.slice((0,A.getFrontMatterInfo)(m).contentStart),v="";Object.keys(p).length>0&&(v=`
`+["#### Properties that could be not be automatically merged",...(0,A.stringifyYaml)(p).trim().split(`
`).map(At=>"- "+At),"","---"].join(`
`)+`

`);let b=(F+`
`+h).replaceAll(`**Paragraph extracted from:**
`,"").replace(/\n{2,}/g,`
`);return u.slice(0,(0,A.getFrontMatterInfo)(u).contentStart)+v+b}),Bt(r),P(r)?.setCursor({line:0,ch:0});let d=[];for(let[u,F]of Object.entries(r.metadataCache.resolvedLinks))Object.keys(F).includes(t.path)&&d.push(u);let f=[...new Set(d)],y=0,T=0;for(let u of f){let F=r.vault.getFileByPath(u);F&&(await r.vault.process(F,h=>{let v=r.metadataCache.getFileCache(F)?.links||[],D=[];for(let b of v){if(b.link!==t.basename&&b.link!==t.path)continue;let{start:k,end:te}=b.position;D.push([k.offset,te.offset])}D.sort((b,k)=>k[0]-b[0]);for(let[b,k]of D){let te=i==="Code File"?"|"+ie(o,e):"",qe=`[[${e.basename}${te}]]`;h=h.slice(0,b)+qe+h.slice(k),T++}return h}),y++)}r.vault.delete(t);let C=T===1?"":"s",w=y===1?"":"s",S=[`"${t.basename}" merged into "${e.basename}".`,`${T} reference${C} in ${y} file${w} updated.`,`A backup of the original files has been saved in the subfolder "${j}."`].join(`

`);new A.Notice(S,1e4)}var Be=class extends O{mergeKeepFile;constructor(e,t){super(e),this.setPlaceholder(`Select Code File to merge into "${t.basename}":`),this.mergeKeepFile=t}getItems(){let e=Fe(this.plugin).filter(t=>t.path!==this.mergeKeepFile.path);return e.length===0&&(new ke.Notice("No other codes have been created yet.",4e3),this.close()),e}getItemText(e){return G(this.plugin,e)}async onChooseItem(e){let{plugin:t,mergeKeepFile:n}=this,i=t.settings.coding.folder;await be(t,n,e,i,"Code File"),E(t,"Code File","merge")}};function mt(o){let e=P(o.app);if(!e)return;if(g(o)!=="Code File"){new ke.Notice("You must be in a Code File for this.",3500);return}let t=e.editorComponent.view.file;if(!t){new ke.Notice("No file open.",4e3);return}new Be(o,t).open()}var ut=require("obsidian");function ft(o){g(o)==="Code File"?(o.app.commands.executeCommandById("workspace:edit-file-title"),E(o,"Code File","rename")):new ut.Notice("You must be in a Code File.",4e3)}var V=require("obsidian");var We=class extends O{codesInParagraph;dataFile;editor;constructor(e,t,n,i){super(e),this.codesInParagraph=i,this.dataFile=n,this.editor=t,this.plugin=e,this.setPlaceholder("Select code to remove from paragraph")}getItems(){return this.codesInParagraph}getItemText(e){return G(this.plugin,e.tFile)}onChooseItem(e){ht(this.plugin,this.editor,this.dataFile,e)}};function ht(o,e,t,n){let i=o.app,r=e.getCursor(),s=e.getLine(r.line),[a]=s.match(Me)||[];if(!a){new V.Notice("Cannot unassign code: no ID found at current line.",0);return}let l=s.replace(n.wikilink,"");e.setLine(r.line,l),r.ch=Math.min(l.length-1,r.ch),e.setCursor(r),i.vault.process(n.tFile,c=>{let p=c.split(`
`),m=p.findIndex(d=>{if(!d.includes(a))return!1;let f=d.match(new RegExp(U,"g"))||[];for(let y of f){let[T,C]=y.match(U)||[];if(!C)continue;if(i.metadataCache.getFirstLinkpathDest(C,n.tFile.path)?.path===t.path)return!0}return!1});if(m<0){let d=`"Code File "${n.tFile.basename}" contains no reference to Data File "${t.basename}" with the ID "${a}". Reference in Code File is thus not deleted.`;return new V.Notice(d,0),c}return p.splice(m,1),c=p.join(`
`),new V.Notice(`Assignment of code "${n.tFile.basename}" removed.`,3500),E(o,"Code File","unassign"),c})}function gt(o){let e=o.app,t=P(e);if(!t)return;if(g(o)!=="Data File"){new V.Notice("You must be in a Data File to unassign a code.",4e3);return}let n=t.editorComponent.view.file;if(!n){new V.Notice("No file open.",4e3);return}let i=he(t),r=t.getLine(i),s=ye(o,n,r);s.length===0?new V.Notice("Line does not contain any codes to remove.",3500):s.length===1?ht(o,t,n,s[0]):new We(o,t,n,s).open()}var yt=[{id:"assign-code",name:"Assign code to paragraph",func:dt,hotkeyLetter:"a",icon:"circle-plus"},{id:"rename-code",name:"Rename code",func:ft,icon:"circle-slash"},{id:"unassign-code",name:"Remove code from paragraph",func:gt,hotkeyLetter:"d",icon:"circle-minus"},{id:"delete-code-everywhere",name:"Delete Code File and all references to it",func:pt,icon:"circle-x"},{id:"merge-codes",name:"Merge another Code File into current Code File",func:mt,icon:"circle-dot"},{id:"bulk-create-new-code-files",name:"Bulk create new Code Files",func:ct,icon:"circle-dashed"},{id:"code-overview-codeblock",name:"Show code overview",func:ot,icon:"circle-equal"}];var ce=require("obsidian");var je=class extends O{editor;constructor(e,t){super(e),this.setPlaceholder("Add paragraph to following Extraction File:"),this.editor=t}getItems(){let{app:e,plugin:t}=this,n=e.vault.getMarkdownFiles().filter(i=>g(t,i)==="Extraction File").sort((i,r)=>r.stat.mtime-i.stat.mtime);return n.length===0&&(new ce.Notice("No extractions have been created yet.",3e3),this.close()),n}getItemText(e){return xe(this.plugin,e)}async onChooseItem(e){let{app:t,editor:n}=this,i=n.editorComponent.view.file;if(!i){new ce.Notice("No file open.",4e3);return}let{blockId:r,lineWithoutId:s}=Z(n);if(n.getLine(n.getCursor().line).includes(`[[${e.basename}]]`)){new ce.Notice(`The paragraph already references "${e.basename}". Aborting.`,0);return}let l=`${i.path.slice(0,-3)}#${r}`,c=`[[${l}]]`;t.fileManager.processFrontMatter(e,p=>{let m=p["extraction-source"];p["extraction-source"]=m?[...m,c]:[c]}),await t.vault.append(e,`![[${l}]]
`),ee(n,e,e.basename,s,r),E(this.plugin,"Extraction File","added paragraph")}};function Ft(o){let e=P(o.app);if(!(!e||q(e)||z(e))){if(g(o)!=="Data File"){new ce.Notice("You must be in a Data File to make an extraction.",4e3);return}new je(o,e).open()}}var _=require("obsidian");var Ke=class extends Y{onSubmit;nameOfNewType="";constructor(e,t){super(e),this.onSubmit=t}onOpen(){let{contentEl:e}=this;e.createEl("h4",{text:"New extraction type"}),e.addClass(this.plugin.cssclass);let t=i=>i!=="",n=()=>{this.close(),this.onSubmit(this.nameOfNewType)};new _.Setting(e).setName("Name of the new type").addText(i=>{i.onChange(r=>{this.nameOfNewType=r.trim(),this.confirmationButton?.setDisabled(!t(r))}).inputEl.addClass("quadro-wide-input"),i.inputEl.addEventListener("keydown",r=>{r.key==="Enter"&&t(this.nameOfNewType)&&(r.preventDefault(),n())})}),new _.Setting(e).addButton(i=>{this.confirmationButton=i.setButtonText("Create").setCta().setDisabled(!0).onClick(n)}).addButton(i=>i.setButtonText("Cancel").onClick(()=>this.close()))}};function Ct(o){let{app:e,settings:t}=o;new Ke(o,async n=>{n=n.replace(/\.md$/,"").replaceAll("/","_").replace(/[:#^?!"*<>|[\]\\]/g,"-").replace(/^\./,"");let i=(0,_.normalizePath)(t.extraction.folder+"/"+n);await e.vault.createFolder(i),new _.Notice(`Creating New Template for Extraction Type "${n}"`,6e3);let s=await e.vault.create(i+"/Template.md",`---
dimension: 
---

`);await se(o,s),e.commands.executeCommandById("file-explorer:reveal-active-file"),we(e,"key")}).open()}var L=require("obsidian");var Wt="-";function wt(o,e){return o.map(n=>`"${n.replaceAll('"','""')}"`).join(e)}async function xt(o){let{app:e,settings:t}=o,n=t.extraction.csvSeparator,i=ae(o);if(!i)return;let r;for(let s of i){let a=[],l=ve(e,s);if(!l){let u=`Export of Extraction Type "${s.name}" is skipped, as the Templade.md has no valid properties.`;new L.Notice(u,0);continue}let c=["File",...Object.keys(l),"extraction-date","extraction-source"],p=wt(c,n);a.push(p);let m=s.children.filter(u=>u instanceof L.TFile&&u.name!=="Template.md");for(let u of m){let F=e.metadataCache.getFileCache(u)?.frontmatter;if(!F)continue;let h=[];for(let D of c){if(D==="File"){h.push(u.basename);continue}let b=F[D]??Wt,k;Array.isArray(b)?k=b.join("; "):typeof b=="object"?k=JSON.stringify(b):k=b.toString(),D==="extraction-source"&&(k=k.replace(/\[\[|\]\]/g,"")),h.push(k)}let v=wt(h,n);a.push(v)}let d=(0,L.normalizePath)(t.analysis.folder+"/CSV Export");e.vault.getFolderByPath(d)||await e.vault.createFolder(d);let y=a.join(`
`),T=(0,L.moment)().format("YYYY-MM-DD_HH-mm-ss"),C=(0,L.normalizePath)(`${d}/${s.name}_${T}.csv`),w=await e.vault.create(C,y),S=w?`Successfully exported "${s.name}".`:`ERROR: Export for "${s.name}" failed.`;new L.Notice(S,w?5e3:0),!r&&w&&(r=w)}new L.Notice("All CSV exports finished.",3500),r&&e.showInFolder(r.path)}var W=require("obsidian");async function vt(o,e,t){let n=o.app;ge(n);let i=t.name,r=t.path,s=e.editorComponent.view.file;if(!s){new W.Notice("No file open.",4e3);return}let a=n.vault.getFileByPath(`${r}/Template.md`);if(!a){new W.Notice(`ERROR: Could not find "Template.md" for Extraction Type "${i}".`,0);return}let l=await n.vault.cachedRead(a),{exists:c,frontmatter:p}=(0,W.getFrontMatterInfo)(l);if(!c){new W.Notice(`The file "Template.md" in the folder "${r}" does not contain valid metadata fields.

You need to add valid fields before you can make extractions.`,0),se(o,a);return}let m,d=$(o,t).length;for(;;){d++;let h=d.toString().padStart(3,"0");if(m=`${r}/${i} ${h}.md`,!n.vault.getFileByPath(m))break}let{blockId:f,lineWithoutId:y}=Z(e),T=p.split(`
`).filter(h=>{let v=h.trim()==="",D=h.match(/^extraction-(date|source):/);return!v&&!D}),C=`${s.path.slice(0,-3)}#${f}`,w=(0,W.moment)().format("YYYY-MM-DDTHH:mm"),S=["---",...T,"extraction-date: "+w,"extraction-source:",`  - "[[${C}]]"`,"---","","**Paragraph extracted from:**",`![[${C}]]`].join(`
`),u=await n.vault.create(m,S),F=u.basename;ee(e,u,F,y,f),await se(o,u),we(n,"value"),E(o,"Extraction File","new")}function Et(o){let{app:e}=o,t=P(e);if(!t||q(t)||z(t)||pe(e))return;if(g(o)!=="Data File"){new W.Notice("You must be in a Data File to make an extraction.",4e3);return}let i=ae(o);i&&(i.length===1?vt(o,t,i[0]):new X(o,r=>{vt(o,t,r)}).open())}var Tt=require("obsidian");function bt(o){new X(o,async e=>{let t="Extraction Overview \u2013 "+e.name,n=["*This file updates automatically, any manual changes to it will be lost.*","","> [!INFO]","> You can use the codeblock property \"filter\" to only show specific values, Click the `</>` icon to edit the filter, for example: `filter: 'word'`, and move the cursor out of the codeblock. (Leave it empty to show all values.)","","```"+Q.extractionOverview,`extraction-type: "${e.name}"`,'filter: ""',"```",""];await fe(o,t,n)}).open()}function kt(o,e){let t=o.app;t.internalPlugins.plugins["global-search"].enable();let n=(0,Tt.parseYaml)(e),i=n["extraction-type"],r=(n.filter||"").trim().toLowerCase(),s=o.settings.extraction.folder+"/"+i,a=n.ignore||[],l=t.vault.getFolderByPath(s);if(!l)return`\u26A0\uFE0F Extraction Type "${i}" invalid.`;let c=ve(t,l);if(!c)return`\u26A0\uFE0F Invalid template or frontmatter for "${i}".`;let p=Object.keys(c),m=$(o,l),d=p.map(y=>{let T=t.metadataTypeManager.getPropertyInfo(y)?.type||"",C=t.metadataCache.getFrontmatterPropertyValuesForKey(y);if(C.length===0)return`<b>${y}</b> <small>not used yet</small><br>`;if(T.startsWith("date")||a.includes(y))return`<b>${y}</b> <small>(type "${T}")</small><br>`;let w=C.reduce((S,u)=>{if(r&&!u.toLowerCase().includes(r))return S;let h=0;for(let b of m){let k=t.metadataCache.getFileCache(b)?.frontmatter?.[y];(k===u||k?.includes(u))&&h++}if(h===0)return S;let v=u.replaceAll('"','\\"'),D=`obsidian://search?query=["${y}":"${v}"] path:"${l.path}"`;return S.push(`<li><a href='${D}'>${u}</a> (${h}x)</li>`),S},[]);return`<b>${y}</b> <small><ul>${w.join("")}</ul></small>`});return(r?`<hr><b>Filter:</b> <mark>${r}</mark><hr><br>`:"")+d.join("")}var le=require("obsidian");var Ye=class extends O{mergeKeepFile;constructor(e,t){super(e),this.setPlaceholder(`Select Extraction File to merge into "${t.basename}":`),this.mergeKeepFile=t}getItems(){let e=this.mergeKeepFile.parent;if(!e)return new le.Notice("No extraction type found (file to be extracted has no parent.)",4e3),this.close(),[];let t=$(this.plugin,e).filter(n=>n.path!==this.mergeKeepFile.path).sort((n,i)=>i.stat.mtime-n.stat.mtime);return t.length===0&&(new le.Notice("No other extractions have been created yet.",4e3),this.close()),t}getItemText(e){return xe(this.plugin,e)}async onChooseItem(e){let{plugin:t,mergeKeepFile:n}=this,i=n.parent?.path||"";await be(t,n,e,i,"Extraction File"),E(t,"Extraction File","merge")}};function Pt(o){let e=P(o.app);if(!e)return;if(g(o)!=="Extraction File"){new le.Notice("You must be in an Extraction File for this.",4e3);return}let t=e.editorComponent.view.file;if(!t){new le.Notice("No file open.",4e3);return}new Ye(o,t).open()}var It=[{id:"extract-from-paragraph",name:"Extract from paragraph",func:Et,hotkeyLetter:"e",icon:"square-plus"},{id:"extract-existing-extraction-file",name:"Add paragraph as source to existing Extraction File",func:Ft,hotkeyLetter:"l",icon:"square-asterisk"},{id:"merge-extractions",name:"Merge another Extraction File into current Extraction File",func:Pt,icon:"square-dot"},{id:"create-new-extraction-type",name:"Create new Extraction Type",func:Ct,icon:"box-select"},{id:"export-all-extractions-as-csv",name:"Export all extractions as .csv",func:xt,icon:"square-arrow-up"},{id:"extractiontypes-overview",name:"Show extraction type overview",func:bt,icon:"square-equal"}];function de(o){let e=o.settings.suppressSuggestionInFields.map(n=>`[data-property-key="${n}"]`).join(", "),t=e?`.app-container:has(.metadata-property:is(${e}) :is(.metadata-input-longtext, .multi-select-container):focus-within) ~ .suggestion-container{ display: none; }`:"";if(!o.styleElSuppressSuggestionsInFields){let n=activeDocument.createElement("style");n.addClass(o.cssclass),n.setAttribute("type","text/css"),activeDocument.head.appendChild(n),o.register(()=>n?.detach()),o.styleElSuppressSuggestionsInFields=n}o.styleElSuppressSuggestionsInFields.textContent=t,o.app.workspace.trigger("css-change")}function Pe(o){let t=`body .metadata-property-key { min-width: ${o.settings.propertiesKeysWidthPercent}% }`;if(!o.styleElPropertyKeyWidth){let n=activeDocument.createElement("style");n.addClass(o.cssclass),n.setAttribute("type","text/css"),activeDocument.head.appendChild(n),o.register(()=>n?.detach()),o.styleElPropertyKeyWidth=n}o.styleElPropertyKeyWidth.textContent=t,o.app.workspace.trigger("css-change")}function He(o){return!!(o&&typeof o=="object"&&!Array.isArray(o))}function Ie(o,...e){if(e.length===0)return o;let t=e.shift();if(He(o)&&He(t))for(let n in t)He(t[n])?(o[n]||Object.assign(o,{[n]:{}}),Ie(o[n],t[n])):Object.assign(o,{[n]:t[n]});return Ie(o,...e)}var x=require("obsidian");function Ve(o){return(0,x.normalizePath)(o).replace(/:/g,"-")}function _e(o){return o.split(`
`).map(e=>e.trim()).filter(e=>e!=="")}var Se=class extends x.PluginSettingTab{plugin;constructor(e){super(e.app,e),this.plugin=e}display(){let{containerEl:e}=this,t=this.plugin.settings;e.empty(),e.addClass(this.plugin.cssclass),new x.Setting(e).setName("Properties without suggestions").setDesc("List of properties, one per line, for which suggestions should be surppressed. This is useful for dimensions which are intended for unique content that is not going to be repeated in other Code Files or Extraction Files.").addTextArea(n=>n.setPlaceholder("One property per line").setValue(t.suppressSuggestionInFields.join(`
`)).onChange(async i=>{t.suppressSuggestionInFields=_e(i),await this.plugin.saveSettings(),de(this.plugin)}).inputEl.addClass("quadro-settings-textarea")),new x.Setting(e).setName("Width of property keys").setDesc("Minimum width of keys in the list of properties, in percent.").addSlider(n=>n.setLimits(20,60,5).setDynamicTooltip().setValue(t.propertiesKeysWidthPercent).onChange(async i=>{t.propertiesKeysWidthPercent=i,await this.plugin.saveSettings(),Pe(this.plugin)})),new x.Setting(e).setName("Shortened statusbar text").setDesc('For example, instead of "20 Codes," the statusbar will display "20C."').addToggle(n=>n.setValue(t.statusbar.shortened).onChange(async i=>{t.statusbar.shortened=i,J(this.plugin),await this.plugin.saveSettings()})),new x.Setting(e).setName("Coding").setHeading(),new x.Setting(e).setName("Code folder").setDesc("Location where the Code Files are stored.").addSearch(n=>{new H(this.plugin,n.inputEl),n.setPlaceholder(N.coding.folder).setValue(t.coding.folder).onChange(async i=>{t.coding.folder=Ve(i)||N.coding.folder,await this.plugin.saveSettings()}).inputEl.addClass("quadro-settings-input")}),new x.Setting(e).setName("Code count").setDesc("When selecting a code to assign, show a count of how often the code has already been assigned. (Note that this is a methodological decision, as it may influence your choice of codes.)").addToggle(n=>n.setValue(t.coding.displayCount).onChange(async i=>{t.coding.displayCount=i,await this.plugin.saveSettings()})),new x.Setting(e).setName("Sort order").setDesc("When selecting a code to assign, method by which the codes are ordered. (Note that this is a methodological decision, as it may influence your choice of codes.)").addDropdown(n=>{for(let i in ne)Object.hasOwn(ne,i)&&n.addOption(i,i);n.setValue(t.coding.sortFunc).onChange(async i=>{t.coding.sortFunc=i,await this.plugin.saveSettings()})}),new x.Setting(e).setName("Extraction").setHeading(),new x.Setting(e).setName("Extraction Folder").setDesc("Location where the Extraction Files are stored.").addSearch(n=>{new H(this.plugin,n.inputEl),n.setPlaceholder(N.extraction.folder).setValue(t.extraction.folder).onChange(async i=>{t.extraction.folder=Ve(i)||N.extraction.folder,await this.plugin.saveSettings()}).inputEl.addClass("quadro-settings-input")}),new x.Setting(e).setName("Extraction count").setDesc("When selecting an extraction type, show a count of how often the type has been extracted.(Note that this is a methodological decision, as it may influence your choice of codes.)").addToggle(n=>n.setValue(t.extraction.displayCount).onChange(async i=>{t.extraction.displayCount=i,await this.plugin.saveSettings()})),new x.Setting(e).setName("Location of extraction window").setDesc("When creating a new extraction, a new split window opens. This setting determines where that window opens.").addDropdown(n=>{n.addOptions(tt).setValue(t.extraction.openingMode).onChange(async i=>{t.extraction.openingMode=i,await this.plugin.saveSettings()})}),new x.Setting(e).setName("Ignore properties on merging").setDesc("List of properties, one per line, which should not trigger manual incongruence resolution when merging Extraction Files. The properties are still added to the frontmatter, there merging just happens automatically without considering potential conflicts. This is intended for properties where it does not matter which value is chosen, such as IDs. ").addTextArea(n=>n.setPlaceholder("One property per line").setValue(t.extraction.ignorePropertyOnMerge.join(`
`)).onChange(async i=>{t.extraction.ignorePropertyOnMerge=_e(i),await this.plugin.saveSettings(),de(this.plugin)}).inputEl.addClass("quadro-settings-textarea")),new x.Setting(e).setName("Display property when merging").setDesc("Property which should be displayed when selecting an Extraction File, for instance when merging Extraction Files. If a list of properties is specified, the first one that exists in the Extraction File is used. For a list of properties, enter one property per line.").addTextArea(n=>n.setPlaceholder("One property per line, the first existing property is used.").setValue(t.extraction.displayProperty.join(`
`)).onChange(async i=>{t.extraction.displayProperty=_e(i),await this.plugin.saveSettings()}).inputEl.addClass("quadro-settings-textarea")),new x.Setting(e).setName("CSV separator").setDesc("Separator used when exporting extractions as CSV file.").addDropdown(n=>{n.addOptions(et).setValue(t.extraction.csvSeparator).onChange(async i=>{t.extraction.csvSeparator=i,await this.plugin.saveSettings()})}),new x.Setting(e).setName("Analysis").setHeading(),new x.Setting(e).setName("Analysis folder").setDesc("Location where overviews, progress, and exports are placed.").addSearch(n=>{new H(this.plugin,n.inputEl),n.setPlaceholder(N.analysis.folder).setValue(t.analysis.folder).onChange(async i=>{t.analysis.folder=Ve(i)||N.analysis.folder,await this.plugin.saveSettings()}).inputEl.addClass("quadro-settings-input")})}};function St(o,e){let t=Object.keys(e).map(n=>jt(o,n,e[n]));return t.length===1?t[0]:function(){t.forEach(n=>n())}}function jt(o,e,t){let n=o[e],i=o.hasOwnProperty(e),r=i?n:function(){return Object.getPrototypeOf(o)[e].apply(this,arguments)},s=t(r);return n&&Object.setPrototypeOf(s,n),Object.setPrototypeOf(a,s),o[e]=a,l;function a(...c){return s===r&&o[e]===a&&l(),s.apply(this,c)}function l(){o[e]===a&&(i?o[e]=r:delete o[e]),s!==r&&(s=r,Object.setPrototypeOf(a,n||Function))}}var De=require("obsidian");function Dt(o){let e=o.app.vault;return St(e,{trash:n=>async(i,r)=>{let s=g(o,i);(s==="Code File"||s==="Extraction File")&&i instanceof De.TFile?(await Kt(o,i),E(o,s,"delete")):s==="Data File"&&E(o,s,"delete"),await n.apply(e,[i,r])}})}async function Kt(o,e){let t=o.app,n=0,i=0,r=[];for(let[m,d]of Object.entries(t.metadataCache.resolvedLinks))Object.keys(d).includes(e.path)&&r.push(m);let s=[...new Set(r)];for(let m of s){let d=t.vault.getFileByPath(m);d&&(await t.vault.process(d,f=>{let y=t.metadataCache.getFileCache(d)?.links||[],T=[];for(let C of y){if(C.link!==e.basename&&C.link!==e.path)continue;let{start:w,end:S}=C.position;T.push([w.offset,S.offset])}T.sort((C,w)=>w[0]-C[0]);for(let[C,w]of T)f[w]===" "&&w++,f=f.slice(0,C)+f.slice(w),i++;return f}),n++)}let a=i===1?"":"s",l=n===1?"":"s",c=i===1?"has":"have",p=["Quadro",`"${e.basename}" was deleted.`,"",`${i} reference${a} in ${n} file${l} ${c} been removed.`].join(`
`);console.info(p),new De.Notice(p,8e3)}var Oe=class extends Ot.Plugin{styleElSuppressSuggestionsInFields;styleElPropertyKeyWidth;cssclass=this.manifest.id;statusbar=this.addStatusBarItem();trashWatcherUninstaller;settings=N;async onload(){console.info(this.manifest.name+" Plugin loaded.");for(let e of[...yt,...It,...Ze]){this.addRibbonIcon(e.icon,`Quadro: ${e.name}`,()=>e.func(this)).addClasses([this.cssclass,"quadro-ribbon-button"]);let n={id:e.id,name:e.name,icon:e.icon,editorCallback:async()=>e.func(this)};e.hotkeyLetter&&(n.hotkeys=[{modifiers:["Mod","Shift"],key:e.hotkeyLetter}]),this.addCommand(n)}this.statusbar.addClass(this.cssclass),J(this),this.registerEvent(this.app.workspace.on("file-open",()=>J(this))),this.registerEvent(this.app.metadataCache.on("resolved",()=>J(this))),this.trashWatcherUninstaller=Dt(this),await this.loadSettings(),this.addSettingTab(new Se(this)),de(this),Pe(this),ge(this.app),this.registerMarkdownCodeBlockProcessor(Q.codeOverview,(e,t)=>{t.innerHTML=it(this),t.addClass(this.cssclass)}),this.registerMarkdownCodeBlockProcessor(Q.extractionOverview,(e,t)=>{t.innerHTML=kt(this,e),t.addClass(this.cssclass)}),window.CodeMirror.defineMode(Q.extractionOverview,e=>window.CodeMirror.getMode(e,"yaml"))}onunload(){this.trashWatcherUninstaller&&this.trashWatcherUninstaller(),window.CodeMirror.defineMode(Q.extractionOverview,e=>window.CodeMirror.getMode(e,"")),console.info(this.manifest.name+" Plugin unloaded.")}async loadSettings(){this.settings=Ie({},N,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}};
