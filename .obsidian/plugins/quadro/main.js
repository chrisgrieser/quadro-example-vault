/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";var X=Object.defineProperty;var Pe=Object.getOwnPropertyDescriptor;var Le=Object.getOwnPropertyNames;var Ne=Object.prototype.hasOwnProperty;var $e=(t,e)=>{for(var o in e)X(t,o,{get:e[o],enumerable:!0})},_e=(t,e,o,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Le(e))!Ne.call(t,i)&&i!==o&&X(t,i,{get:()=>e[i],enumerable:!(n=Pe(e,i))||n.enumerable});return t};var Be=t=>_e(X({},"__esModule",{value:!0}),t);var Ye={};$e(Ye,{default:()=>Y});module.exports=Be(Ye);var Oe=require("obsidian");var I=require("obsidian");function Me(t){return Math.ceil(Math.random()*10**t).toString().padStart(t,"0")}var Ge=/\^[\w-]+(?=\n|$)/g,V=/\^[\w-]+$/,de=/^!\[\[(.+?)#(\^[\w-]+)\]\]$/;async function G(t,e){let[o]=e.match(V)||[];if(o){let s=e.slice(0,-o.length).trim();return{blockId:o,lineWithoutId:s}}let i=(await t.vault.cachedRead(t)).match(Ge)||[],r;do r="^id-"+Me(6);while(i.includes(r));return{blockId:r,lineWithoutId:e.trim()}}var m="Codes",f="Extractions",K="Analysis",W=!0,ue={char:"\u{1FB0B}",charsPerBlock:100,maxLength:100},We={alphabeticalByCodeName:(t,e)=>t.basename.localeCompare(e.basename),alphabeticalByFullCode:(t,e)=>{let o=t.path.slice(m.length+1),n=e.path.slice(m.length+1);return o.localeCompare(n)},lastUsedFirst:(t,e)=>e.stat.mtime-t.stat.mtime,oldestUsedFirst:(t,e)=>t.stat.mtime-e.stat.mtime,frequentlyUsedFirst:(t,e)=>e.stat.size-t.stat.size,rarelyUsedFirst:(t,e)=>t.stat.size-e.stat.size,randomOrder:()=>Math.random()-.5},me=We.lastUsedFirst;var L=require("obsidian");function h(t,e){let o=e==="Codes"?m:f,n=t.workspace.getActiveFile();return n?!!n.path.startsWith(o+"/"):!1}function T(t){let e=t.workspace.getActiveViewOfType(L.MarkdownView);return e?e.editor:(new L.Notice("No active editor."),null)}var w=W?[{command:"\u2191\u2193",purpose:"Navigate"},{command:"\u23CE",purpose:"Select"},{command:"esc",purpose:"Dismiss"}]:[];function U(t){let e=`.workspace-leaf.mod-active .metadata-property:first-of-type .metadata-property-${t} :is([contenteditable='true'], input)`,o=document.querySelector(e);o instanceof HTMLElement&&Ue(o,0),o instanceof HTMLInputElement&&o.select()}function Ue(t,e){if(t instanceof HTMLInputElement){t.focus();let o=t.getAttribute("type")==="number";o&&t.setAttribute("type","text"),t.setSelectionRange(e,e),o&&t.setAttribute("type","number")}else{let o=document.createRange(),n=window.getSelection();o.setStart(t,e),o.collapse(!0),n?.removeAllRanges(),n?.addRange(o)}}var Q={state:{source:!1,mode:"source"}};async function N(t,e){let o=t.workspace.getLeaf();await(t.workspace.getAdjacentLeafInDirection(o,"right")||t.workspace.createLeafBySplit(o,"vertical",!1)).openFile(e,Q)}function S(t){let e=t.getCursor("head").line!==t.getCursor("anchor").line,o=t.listSelections().length>1;return e||o?(new L.Notice(`Paragraph not unambiguous since multiple lines are selected.

Unselect, move your cursor to the paragraph you want to affect, and use the command again.`,5e3),!0):!1}function $(t){return t.path.slice(m.length+1,-3)}var p=require("obsidian");var J=class extends p.Modal{constructor(o,n){super(o);this.fullCode="";this.codeDesc="";this.confirmationButton=null;this.onSubmit=n,this.modalEl.addClass("quadro")}onOpen(){let{contentEl:o}=this;o.createEl("h4",{text:"New code creation"}),new p.Setting(o).setName("Name of the Code").setDesc('Use a slash ("/") in the name to create the Code File in a subfolder (group).').addText(n=>n.onChange(i=>{this.fullCode=i.trim(),this.confirmationButton?.setDisabled(this.fullCode==="")})),new p.Setting(o).setName("Code Description").setDesc('Will be added as metadata with the key "description".').addText(n=>n.onChange(i=>{this.codeDesc=i.trim()})),new p.Setting(o).addButton(n=>{this.confirmationButton=n.setButtonText("Create").setCta().setDisabled(!0).onClick(()=>{this.close(),this.onSubmit(this.fullCode,this.codeDesc)})}).addButton(n=>n.setButtonText("Cancel").onClick(()=>this.close()))}onClose(){let{contentEl:o}=this;o.empty()}},Z=class extends p.Modal{constructor(o,n){super(o);this.input="";this.confirmationButton=null;this.onSubmit=n,this.modalEl.addClass("quadro")}onOpen(){let{contentEl:o}=this;o.createEl("h4",{text:"Bulk-create new codes"}),o.createEl("p",{text:"Every line will result in a new code file."}),o.createEl("p",{text:'Use a slash ("/") in the name to create the Code File in a subfolder (group).'}),new p.Setting(o).setClass("quadro-bulk-code-creation").addTextArea(n=>n.onChange(i=>{this.input=i.trim(),this.confirmationButton?.setDisabled(this.input==="")})),new p.Setting(o).addButton(n=>{this.confirmationButton=n.setButtonText("Create").setCta().setDisabled(!0).onClick(()=>{this.close(),this.onSubmit(this.input)})}).addButton(n=>n.setButtonText("Cancel").onClick(()=>this.close()))}onClose(){let{contentEl:o}=this;o.empty()}};async function pe(t,e,o){e=e.replace(/\.md$/,"").replace(/[:#^?!"*<>|[\]\\]/g,"-").replace(/^\.|\/\./g,"");let n=(0,p.normalizePath)(`${m}/${e}.md`);if(t.vault.getAbstractFileByPath(n)instanceof p.TFile)return new p.Notice(`Code "${e}" already exists, Code File not created.`),!1;let r=e.split("/"),s=r.pop(),l=r.length?"/"+r.join("/"):"",a=m+l;t.vault.getFolderByPath(a)||await t.vault.createFolder(a),o=o.replaceAll('"',"'");let d=`---
description: "${o}"
---


---

`;return await t.vault.create(`${a}/${s}.md`,d)}function he(t,e){new J(t,async(o,n)=>{let i=await pe(t,o,n);i?(new p.Notice(`Created new code file: "${o}"`),e(i)):new p.Notice("File creation failed.")}).open()}async function fe(t){new Z(t,async e=>{let o=0,n=[];for(let r of e.split(`
`))await pe(t,r,"")?o++:n.push(r);let i=`${o} file(s) created`;n.length>0&&(i+=`
Could not create: `+n.join(", ")),new p.Notice(i,(n.length+2)*1e3)}).open()}var ee=class extends I.FuzzySuggestModal{constructor(e,o,n,i){super(e),this.editor=o,this.codesInPara=n,this.dataFile=i,this.setPlaceholder("Select code to assign"),this.setInstructions([...w,{command:'type "new"',purpose:"Create new code"}]),this.modalEl.addClass("quadro")}getItems(){let e=this.app.vault.getMarkdownFiles().filter(o=>{let n=o.path.startsWith(m+"/"),i=this.codesInPara.find(r=>r.path===o.path);return n&&!i}).sort(me);return e.push("new-code-file"),e}getItemText(e){if(e==="new-code-file")return"\u{1F79C} Create new code";let{char:o,charsPerBlock:n,maxLength:i}=ue,r="    "+o.repeat(Math.min(i,e.stat.size/n));return $(e)+r}onChooseItem(e){e instanceof I.TFile?this.assignCode(e,this.dataFile):he(this.app,o=>this.assignCode(o,this.dataFile))}async assignCode(e,o){let n=this.editor.getCursor(),i=$(e),r=this.editor.getLine(n.line),s=this.editor.getSelection();if(s){let C=s.replace(/^( ?)(.+?)( ?)$/g,"$1==$2==$3");this.editor.replaceSelection(C),r=this.editor.getLine(n.line)}let{blockId:l,lineWithoutId:a}=await G(o,r),c=`${a} [[${i}]] ${l}`;this.editor.setLine(n.line,c),this.editor.setCursor(n);let u=`![[${o.path.slice(0,-3)}#${l}]]
`;await this.app.vault.append(e,u)}};function ge(t){let e=T(t);if(!e||S(e))return;if(h(t,"Codes")||h(t,"Extractions")){new I.Notice("You must be in a Data File to assign a code.",3e3);return}if(e.getSelection().includes("==")){new I.Notice(`Selection contains highlights.
Overlapping highlights are not supported.`);return}let n=e.editorComponent.view.file,s=(e.getLine(e.getCursor().line).match(/\[\[.+?\]\]/g)||[]).reduce((l,a)=>{a=a.slice(2,-2);let c=t.metadataCache.getFirstLinkpathDest(a,n.path);return c?.path.startsWith(m+"/")&&l.push(c),l},[]);new ee(t,e,s,n).open()}var y=require("obsidian");var g=require("obsidian");var te=class extends g.FuzzySuggestModal{constructor(e,o,n,i){super(e),this.codesInParagraph=i,this.dataFile=n,this.editor=o,this.setPlaceholder("Select code to remove from paragraph"),this.setInstructions(w),this.modalEl.addClass("quadro")}getItems(){return this.codesInParagraph}getItemText(e){return $(e.tFile)}onChooseItem(e){Fe(this.editor,this.dataFile,e)}};async function oe(t,e,o,n){let i=(await t.vault.read(o)).split(`
`),r=i.findIndex(c=>c.endsWith(n));if(r<0)return`Data File "${o.basename}", has no line with the ID "${n}".`;let s=i[r]||"",a=(s.match(/\[\[.+?\]\]/g)||[]).find(c=>{c=c.slice(2,-2);let d=t.metadataCache.getFirstLinkpathDest(c,o.path);return d instanceof g.TFile&&d.path===e.path});return a?(i[r]=s.replace(a,"").replace(/ {2,}/g," "),await t.vault.modify(o,i.join(`
`)),""):`Data File "${o.basename}", line "${n}" has no valid link to the Code File.`}async function Fe(t,e,o){let n=t.editorComponent.app,i=t.getCursor().line,r=t.getLine(i),s=new RegExp(" ?\\[\\["+o.wikilink+"\\]\\]");t.setLine(i,r.replace(s,""));let[l]=r.match(V)||[];if(!l){new g.Notice(`No ID found in current line.
Reference in Code File thus not deleted.`);return}let a=(await n.vault.read(o.tFile)).split(`
`),c=a.findIndex(d=>{if(!d.includes(l))return!1;let u=d.match(/\[\[.+?\]\]/g)||[];for(let C of u){let v=C.slice(2,-2).split("#")[0]||"";if(n.metadataCache.getFirstLinkpathDest(v,o.tFile.path)?.path===e.path)return!0}return!1});if(c<0){new g.Notice(`"Code File "${o.tFile.basename}" contains not reference to Data File "${e.basename}" with the ID "${l}". Reference in Code File is thus not deleted.`,7e3);return}a.splice(c,1),await n.vault.modify(o.tFile,a.join(`
`)),new g.Notice(`Assignment of code "${o.tFile.basename}" removed.`)}async function je(t,e){let o=e.getLine(e.getCursor().line),[n,i,r]=o.match(de)||[],s=e.editorComponent.view.file,l=t.metadataCache.getFirstLinkpathDest(i||"",s.path);if(!r||!i||!l){new g.Notice("Current line has no correct reference.");return}let a=await oe(t,s,l,r);if(a){new g.Notice(a+`

Aborting removal of Code.`,4e3);return}t.commands.executeCommandById("editor:delete-paragraph"),e.setCursor({line:e.getCursor().line,ch:0}),new g.Notice(`Assignment of code "${s.basename}" removed.`)}async function Ce(t){let e=T(t);if(!(!e||S(e)))if(h(t,"Codes"))je(t,e);else{let o=e.editorComponent.view.file,r=(e.getLine(e.getCursor().line).match(/\[\[.+?\]\]/g)||[]).reduce((s,l)=>{l=l.slice(2,-2);let a=t.metadataCache.getFirstLinkpathDest(l,o.path);return a instanceof g.TFile&&a.path.startsWith(m+"/")&&s.push({tFile:a,wikilink:l}),s},[]);r.length===0?new g.Notice("Line does not contain any valid codes."):r.length===1?Fe(e,o,r[0]):new te(t,e,o,r).open()}}var ne=!1;async function Te(t,e){if(!(e instanceof y.TFile)||!e.path.startsWith(m+"/")||ne)return;if(t.vault.config.trashOption!=="local"){let n=`\u26A0\uFE0F Code Files must be deleted via the "Delete Code Everywhere" command to ensure that references to it are correctly deleted as well. Alternatively, you can set the trash location to "local" in your Obsidian config to have Quadro automatically handle deletions.

Please restore the file and do one of the above to correctly remove the code.
(Click to dismiss.)`;new y.Notice(n,0);return}let o=".trash/"+e.name;if(!await t.vault.adapter.exists(o)){let n=`Could not remove references to the Code File.

Please restore the file and use the "Delete Code Everywhere" command.`;new y.Notice(n,8e3);return}await t.vault.adapter.rename(o,e.path),setTimeout(async()=>{ne=!0,await xe(t,e),ne=!1},1e3)}async function Ee(t){let e=T(t);if(!e)return;if(!h(t,"Codes")){new y.Notice("Must be in Code File to delete the code everywhere.");return}let o=e.editorComponent.view.file;xe(t,o)}async function xe(t,e){let n=(t.metadataCache.getFileCache(e)?.embeds||[]).map(l=>l.link).reduce((l,a)=>{let[c,d]=a.split("#");if(!c||!d)return l;let u=t.metadataCache.getFirstLinkpathDest(c,e.path);return u instanceof y.TFile&&l.push({file:u,blockId:d}),l},[]),i=[];for(let{file:l,blockId:a}of n){let c=await oe(t,e,l,a);c&&i.push(c)}await t.vault.trash(e,!0);let r=n.length-i.length,s=`Code File "${e.basename}" and ${r} references to it deleted.
`;i.length>0&&(s+=`
\u26A0\uFE0F ${i.length} references could not be deleted:
- `+i.join(`
- `)),new y.Notice(s,(5+i.length)*1700)}var we=require("obsidian");function ye(t){h(t,"Codes")?t.commands.executeCommandById("workspace:edit-file-title"):new we.Notice("You must be in a code file.")}var ve=[{id:"assign-code",name:"Assign code to paragraph",func:ge,hotkeyLetter:"a",ribbonIcon:"plus-circle"},{id:"rename-code",name:"Rename code",func:ye,hotkeyLetter:"r",ribbonIcon:"circle-slash"},{id:"unassign-code",name:"Delete code from paragraph",func:Ce,hotkeyLetter:"d",ribbonIcon:"minus-circle"},{id:"delete-code-everywhere",name:"Delete code file and all references to it",func:Ee,ribbonIcon:"x-circle"},{id:"bulk-create-new-code-files",name:"Bulk create new code files",func:fe,ribbonIcon:"circle-dashed"}];var k=require("obsidian");var A=require("obsidian");function j(t,e){let o=t.vault.getFileByPath(`${e.path}/Template.md`);if(!o){new A.Notice(`ERROR: Could not find "Template.md" for Extraction Type "${e.name}".`,5e3);return}let n=t.metadataCache.getFileCache(o)?.frontmatter;if(!n){new A.Notice(`ERROR: Properties of "Template.md" for Extraction Type "${e.name}" are invalid.`,5e3);return}return n}function q(t){let e=t.vault.getFolderByPath(f);if(!e){new A.Notice("ERROR: Could not find Extraction Folder.",4e3);return}let o=e.children.filter(n=>n instanceof A.TFolder);if(o.length===0){new A.Notice("ERROR: Could not find any Extraction Types.",4e3);return}return o}var ie=class extends k.FuzzySuggestModal{constructor(e,o){super(e),this.extractionTypes=o,this.setPlaceholder("Select extraction type to create aggregation for"),this.setInstructions(w),this.modalEl.addClass("quadro")}getItems(){return this.extractionTypes}getItemText(e){let o=e.children.length-1;return`${e.name} (${o})`}async onChooseItem(e){let o=j(this.app,e);if(!o)return;let n=Object.keys(o).map(u=>"	"+u.replaceAll(" ","-")+",");n.push("	extraction-source");let i=["---","","You can customize the table by modifying the Dataview Query: [Documentation of Dataview Queries](https://blacksmithgu.github.io/obsidian-dataview/queries/structure/)","There is also an Online Query Builder, facilitating the writing of the queries: [Dataview Query Builder](https://s-blu.github.io/basic-dataview-query-builder/)","","If you have the [Sortable](https://obsidian.md/plugins?id=obsidian-sortable) plugin installed, you can click on the header row of a column to sort the table by that column. (The plugin is pre-installed, if you use the Quadro Example Vault.)","","You can achieve manual sorting of rows by adding a dummy property like `manual sort` to your query and to all specific extractions you want to group together. This is also useful as you can switch between your manual order and ordering by a specific column."],r=["```dataview","TABLE",...n,`FROM "${e.path}"`,'WHERE file.name != "Template"',"SORT extraction-date ASC","```","",...W?i:[]].join(`
`),s=this.app.vault.getFolderByPath(f);if(s||(s=await this.app.vault.createFolder(K)),!s){new k.Notice("ERROR: Could not create Analysis Folder.",4e3);return}let l=e.name,a;for(;a=`${K}/${l}.md`,!!this.app.vault.getFileByPath(a);)l+="_1";let c=await this.app.vault.create(a,r);await this.app.workspace.getLeaf().openFile(c,Q),this.app.commands.executeCommandById("file-explorer:reveal-active-file");let d=T(this.app);d&&d.setCursor(d.lastLine(),0)}};async function be(t){if(![...t.plugins.enabledPlugins].includes("dataview")){if(!Object.keys(t.plugins.plugins).includes("dataview")){new k.Notice(`Plugin "Dataview" not installed.

Please install it from the Obsidian Community Store.`,7e3);return}if(!await t.plugins.enablePluginAndSave("dataview")){new k.Notice("ERROR: Dataview plugin could not be enabled.",4e3);return}}let o=q(t);o&&new ie(t,o).open()}var F=require("obsidian");var re=class extends F.Modal{constructor(o,n){super(o);this.nameOfNewType="";this.confirmationButton=null;this.onSubmit=n,this.modalEl.addClass("quadro")}onOpen(){let{contentEl:o}=this;o.createEl("h4",{text:"New Extraction Type"}),new F.Setting(o).setName("Name of the new type").addText(n=>n.onChange(i=>{this.nameOfNewType=i.trim(),this.confirmationButton?.setDisabled(this.nameOfNewType==="")})),new F.Setting(o).addButton(n=>{this.confirmationButton=n.setButtonText("Create").setCta().setDisabled(!0).onClick(()=>{this.close(),this.onSubmit(this.nameOfNewType)})}).addButton(n=>n.setButtonText("Cancel").onClick(()=>this.close()))}onClose(){let{contentEl:o}=this;o.empty()}};function ae(t){new re(t,async e=>{e=e.replace(/\.md$/,"").replaceAll("/","_").replace(/[:#^?!"*<>|[\]\\]/g,"-").replace(/^\./,"");let o=(0,F.normalizePath)(f+"/"+e);if(!(await t.vault.createFolder(o)instanceof F.TFolder)){new F.Notice("ERROR: Could not create Extraction Type Folder.",3e3);return}se(t,e)}).open()}async function se(t,e){new F.Notice(`Creating New Template for Extraction Type "${e}"`,6e3);let o=(0,F.normalizePath)(`${f}/${e}/Template.md`),i=await t.vault.create(o,`---
dimension: 
---

`);await N(t,i),t.commands.executeCommandById("file-explorer:reveal-active-file"),U("key")}function Ie(t){ae(t)}var D=require("obsidian");var qe=",",ze="-",le="CSV Export";function Ae(t){return t.map(o=>`"${o.replaceAll('"','""')}"`).join(qe)}async function Re(t){let e=q(t);if(!e)return;let o;for(let n of e){let i=[],r=j(t,n);if(!r){new D.Notice(`Export of Extraction Type "${n.name}" is skipped.`,5e3);continue}let s=["File",...Object.keys(r),"extraction date","extraction source"],l=Ae(s);i.push(l);let a=n.children.filter(x=>x instanceof D.TFile&&x.name!=="Template.md");for(let x of a){let _=t.metadataCache.getFileCache(x)?.frontmatter;if(!_)continue;let B=[];for(let O of s){if(O==="File"){B.push(x.basename);continue}let b=_[O]??ze,P=typeof b!="object"?b.toString():Array.isArray(b)?b.join("; "):JSON.stringify(b);O==="extraction source"&&(P=P.slice(2,-2)),B.push(P)}let H=Ae(B);i.push(H)}t.vault.getFolderByPath(le)||await t.vault.createFolder(le);let d=i.join(`
`),u,C=n.name;for(;u=`${le}/${C}.csv`,!!t.vault.getFileByPath(u);)C+="_1";let v=await t.vault.create(u,d),R=v?`Successfully exported "${n.name}".`:`ERROR: Export for "${n.name}" failed.`;new D.Notice(R,5e3),!o&&v&&(o=v)}new D.Notice("All CSV exports finished.",5e3),o&&t.showInFolder(o.path)}var E=require("obsidian");var ce=class extends E.FuzzySuggestModal{constructor(e,o,n,i){super(e),this.extractionTypes=n,this.editor=o,this.dataFile=i,this.setPlaceholder("Select extraction type"),this.setInstructions(w),this.modalEl.addClass("quadro")}getItems(){return this.extractionTypes}getItemText(e){let o=e.children.find(r=>r instanceof E.TFile&&r.name==="Template.md"),n=e.children.length-1,i=o?`  (${n})`:'  [Select to create "Template.md"]';return e.name+i}onChooseItem(e){Se(this.editor,this.dataFile,e)}};async function Se(t,e,o){let n=t.editorComponent.app,i=o.name,r=o.path,s=n.vault.getFileByPath(`${r}/Template.md`);if(!s){se(n,i);return}let a=(await n.vault.cachedRead(s)).trim().split(`
`);if(!(a.filter(M=>M==="---").length===2)){new E.Notice(`The file "Template.md" in the folder "${r}" does not contain valid metadata fields.

You need to add valid fields before you can make extractions.`,6e3),N(n,s);return}let d,u=o.children.length-1;for(;u++,d=`${r}/${u}.md`,!!n.vault.getFileByPath(d););let C=t.getCursor(),v=t.getLine(C.line),{blockId:R,lineWithoutId:x}=await G(e,v),_=`${x} [[${i}/${u}]] ${R}`;t.setLine(C.line,_),t.setCursor(C);let H=`extraction date: ${new Date().toISOString().slice(0,-5)}`,O=`extraction source: "[[${e.path}#${R}]]"`,b=a.findLastIndex(M=>M==="---");a.splice(b,0,H,O),a.push("",`**Paragraph extracted from:** ![[${e.path}#${R}]]`);let P=await n.vault.create(d,a.join(`
`));await N(n,P),U("value")}async function ke(t){let e=T(t);if(!e||S(e))return;if(h(t,"Codes")||h(t,"Extractions")){new E.Notice("You must be in a Data File to make an extraction.",3e3);return}let o=t.vault.getFolderByPath(f);if(o||(o=await t.vault.createFolder(f)),!o){new E.Notice("ERROR: Could not create Extraction Folder.",4e3);return}let n=o.children.filter(r=>r instanceof E.TFolder),i=e.editorComponent.view.file;n.length===0?ae(t):n.length===1&&n[0]?Se(e,i,n[0]):new ce(t,e,n,i).open()}var De=[{id:"extract-from-paragraph",name:"Extract from paragraph",func:ke,hotkeyLetter:"e",ribbonIcon:"plus-square"},{id:"create-new-extraction-type",name:"Create new extraction type",func:Ie,ribbonIcon:"box-select"},{id:"aggregate-extractions",name:"Aggregate extractions",func:be,ribbonIcon:"sigma-square"},{id:"export-all-extractions-as-csv",name:"Export all extractions as .csv",func:Re,ribbonIcon:"arrow-up-square"}];function z(t,e){let o=t.workspace.getActiveFile();if(!o){e.setText("");return}let n=[],i=t.metadataCache.resolvedLinks[o.path]||{};if(h(t,"Codes")){let a=0;for(let[c,d]of Object.entries(i))a+=d;n.push(`Code ${a}x assigned`)}else if(h(t,"Extractions")){let c=o.parent.children.length-1;n.push(`${c}x extracted`)}else{let a=0,c=0;for(let[d,u]of Object.entries(i))d.startsWith(m+"/")&&(a+=u),d.startsWith(f+"/")&&c++;a>0&&n.push(`${a} Codes`),c>0&&n.push(`${c} Extractions`)}let r=t.metadataCache.unresolvedLinks[o.path]||{},s=0;for(let[a,c]of Object.entries(r))s+=c;s>0&&n.push(`${s} invalid links`);let l=n.map(a=>a.replace(/^(1 .*)s$/,"$1")).join(", ");e.setText(l)}var Y=class extends Oe.Plugin{constructor(){super(...arguments);this.statusbar=this.addStatusBarItem()}onload(){console.info(this.manifest.name+" Plugin loaded.");for(let o of[...ve,...De]){this.addRibbonIcon(o.ribbonIcon,`Quadro: ${o.name}`,()=>o.func(this.app));let n={id:o.id,name:o.name,editorCallback:()=>o.func(this.app)};o.hotkeyLetter&&(n.hotkeys=[{modifiers:["Mod","Shift"],key:o.hotkeyLetter}]),this.addCommand(n)}z(this.app,this.statusbar),this.registerEvent(this.app.workspace.on("file-open",()=>z(this.app,this.statusbar))),this.registerEvent(this.app.metadataCache.on("resolved",()=>z(this.app,this.statusbar))),this.registerEvent(this.app.vault.on("delete",o=>Te(this.app,o)))}onunload(){console.info(this.manifest.name+" Plugin unloaded.")}};
